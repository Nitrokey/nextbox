"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.mergeMetricsByKey = void 0;
const fill_1 = __importDefault(require("lodash/fill"));
const map_1 = __importDefault(require("lodash/map"));
const mergeWith_1 = __importDefault(require("lodash/mergeWith"));
const mergeWithRuns = (index, count) => (objValue, srcValue) => {
    const res = objValue && objValue.runs
        ? [...objValue.runs]
        : fill_1.default(Array(count), null);
    res[index] = srcValue;
    return {
        runs: res,
    };
};
const mergeMetricsByKey = (runs) => {
    const runsCount = runs.length;
    const metricsById = runs.reduce((aggregator, run, index) => mergeWith_1.default(aggregator, run, mergeWithRuns(index, runsCount)), {});
    return map_1.default(metricsById, (value, key) => ({
        key,
        ...value,
    }));
};
exports.mergeMetricsByKey = mergeMetricsByKey;
//# sourceMappingURL=merge-metrics-by-key.js.map