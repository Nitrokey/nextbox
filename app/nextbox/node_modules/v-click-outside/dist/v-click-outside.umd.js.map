{"version":3,"file":"v-click-outside.umd.js","sources":["../src/v-click-outside.js","../src/index.js"],"sourcesContent":["const HANDLERS_PROPERTY = '__v-click-outside'\nconst HAS_WINDOWS = typeof window !== 'undefined'\nconst HAS_NAVIGATOR = typeof navigator !== 'undefined'\nconst IS_TOUCH =\n  HAS_WINDOWS &&\n  ('ontouchstart' in window ||\n    (HAS_NAVIGATOR && navigator.msMaxTouchPoints > 0))\nconst EVENTS = IS_TOUCH ? ['touchstart'] : ['click']\n\nfunction processDirectiveArguments(bindingValue) {\n  const isFunction = typeof bindingValue === 'function'\n  if (!isFunction && typeof bindingValue !== 'object') {\n    throw new Error(\n      'v-click-outside: Binding value must be a function or an object',\n    )\n  }\n\n  return {\n    handler: isFunction ? bindingValue : bindingValue.handler,\n    middleware: bindingValue.middleware || ((item) => item),\n    events: bindingValue.events || EVENTS,\n    isActive: !(bindingValue.isActive === false),\n    detectIframe: !(bindingValue.detectIframe === false),\n  }\n}\n\nfunction execHandler({ event, handler, middleware }) {\n  if (middleware(event)) {\n    handler(event)\n  }\n}\n\nfunction onFauxIframeClick({ el, event, handler, middleware }) {\n  // Note: on firefox clicking on iframe triggers blur, but only on\n  //       next event loop it becomes document.activeElement\n  // https://stackoverflow.com/q/2381336#comment61192398_23231136\n  setTimeout(() => {\n    const { activeElement } = document\n    if (\n      activeElement &&\n      activeElement.tagName === 'IFRAME' &&\n      !el.contains(activeElement)\n    ) {\n      execHandler({ event, handler, middleware })\n    }\n  }, 0)\n}\n\nfunction onEvent({ el, event, handler, middleware }) {\n  // Note: composedPath is not supported on IE and Edge, more information here:\n  //       https://developer.mozilla.org/en-US/docs/Web/API/Event/composedPath\n  //       In the meanwhile, we are using el.contains for those browsers, not\n  //       the ideal solution, but using IE or EDGE is not ideal either.\n  const path = event.path || (event.composedPath && event.composedPath())\n  const isClickOutside = path\n    ? path.indexOf(el) < 0\n    : !el.contains(event.target)\n\n  if (!isClickOutside) {\n    return\n  }\n\n  execHandler({ event, handler, middleware })\n}\n\nfunction bind(el, { value }) {\n  const {\n    events,\n    handler,\n    middleware,\n    isActive,\n    detectIframe,\n  } = processDirectiveArguments(value)\n  if (!isActive) {\n    return\n  }\n\n  el[HANDLERS_PROPERTY] = events.map((eventName) => ({\n    event: eventName,\n    srcTarget: document.documentElement,\n    handler: (event) => onEvent({ el, event, handler, middleware }),\n  }))\n\n  if (detectIframe) {\n    const detectIframeEvent = {\n      event: 'blur',\n      srcTarget: window,\n      handler: (event) => onFauxIframeClick({ el, event, handler, middleware }),\n    }\n\n    el[HANDLERS_PROPERTY] = [...el[HANDLERS_PROPERTY], detectIframeEvent]\n  }\n\n  el[HANDLERS_PROPERTY].forEach(({ event, srcTarget, handler }) =>\n    setTimeout(() => {\n      // Note: More info about this implementation can be found here:\n      //       https://github.com/ndelvalle/v-click-outside/issues/137\n      if (!el[HANDLERS_PROPERTY]) {\n        return\n      }\n      srcTarget.addEventListener(event, handler, false)\n    }, 0),\n  )\n}\n\nfunction unbind(el) {\n  const handlers = el[HANDLERS_PROPERTY] || []\n  handlers.forEach(({ event, srcTarget, handler }) =>\n    srcTarget.removeEventListener(event, handler, false),\n  )\n  delete el[HANDLERS_PROPERTY]\n}\n\nfunction update(el, { value, oldValue }) {\n  if (JSON.stringify(value) === JSON.stringify(oldValue)) {\n    return\n  }\n  unbind(el)\n  bind(el, { value })\n}\n\nconst directive = {\n  bind,\n  update,\n  unbind,\n}\n\nexport default HAS_WINDOWS ? directive : {}\n","import directive from './v-click-outside'\n\nconst plugin = {\n  install(Vue) {\n    Vue.directive('click-outside', directive)\n  },\n  directive,\n}\n\nexport default plugin\n"],"names":["HAS_WINDOWS","window","HAS_NAVIGATOR","navigator","EVENTS","msMaxTouchPoints","execHandler","event","handler","middleware","bind","el","bindingValue","isFunction","Error","item","events","isActive","detectIframe","processDirectiveArguments","value","map","eventName","srcTarget","document","documentElement","path","composedPath","indexOf","contains","target","onEvent","detectIframeEvent","setTimeout","activeElement","tagName","onFauxIframeClick","forEach","addEventListener","unbind","removeEventListener","update","oldValue","JSON","stringify","install","Vue","directive"],"mappings":"2LAAA,IACMA,EAAgC,oBAAXC,OACrBC,EAAqC,oBAAdC,UAKvBC,EAHJJ,IACC,iBAAkBC,QAChBC,GAAiBC,UAAUE,iBAAmB,GACzB,CAAC,cAAgB,CAAC,SAmB5C,SAASC,SAAcC,IAAAA,MAAOC,IAAAA,SACxBC,IADiCA,YACtBF,IACbC,EAAQD,GAqCZ,SAASG,EAAKC,WAxDd,SAAmCC,GACjC,IAAMC,EAAqC,mBAAjBD,EAC1B,IAAKC,GAAsC,iBAAjBD,EACxB,UAAUE,MACR,kEAIJ,MAAO,CACLN,QAASK,EAAaD,EAAeA,EAAaJ,QAClDC,WAAYG,EAAaH,YAAe,SAACM,UAASA,GAClDC,OAAQJ,EAAaI,QAAUZ,EAC/Ba,YAAsC,IAA1BL,EAAaK,UACzBC,gBAA8C,IAA9BN,EAAaM,eAkD3BC,GAPcC,OAGhBZ,IAAAA,QACAC,IAAAA,WAEAS,IAAAA,aAEF,KAHED,SAGF,CAUA,GANAN,EA7EwB,uBAmEtBK,OAU6BK,IAAI,SAACC,SAAe,CACjDf,MAAOe,EACPC,UAAWC,SAASC,gBACpBjB,QAAS,SAACD,UAhCd,gBAAmBI,IAAAA,GAAIJ,IAAAA,MAAOC,IAAAA,QAASC,IAAAA,WAK/BiB,EAAOnB,EAAMmB,MAASnB,EAAMoB,cAAgBpB,EAAMoB,gBACjCD,EACnBA,EAAKE,QAAQjB,GAAM,GAClBA,EAAGkB,SAAStB,EAAMuB,UAMvBxB,EAAY,CAAEC,MAAAA,EAAOC,QAAAA,EAASC,WAAAA,IAkBRsB,CAAQ,CAAEpB,GAAAA,EAAIJ,MAAAA,EAAOC,QAAAA,EAASC,WAAAA,QAGhDS,EAAc,CAChB,IAAMc,EAAoB,CACxBzB,MAAO,OACPgB,UAAWtB,OACXO,QAAS,SAACD,UAvDhB,gBAA6BI,IAAAA,GAAIJ,IAAAA,MAAOC,IAAAA,QAASC,IAAAA,WAI/CwB,WAAW,eACDC,EAAkBV,SAAlBU,cAENA,GAC0B,WAA1BA,EAAcC,UACbxB,EAAGkB,SAASK,IAEb5B,EAAY,CAAEC,MAAAA,EAAOC,QAAAA,EAASC,WAAAA,KAE/B,GA0CqB2B,CAAkB,CAAEzB,GAAAA,EAAIJ,MAAAA,EAAOC,QAAAA,EAASC,WAAAA,MAG9DE,EA1FsB,+BA0FMA,EA1FN,sBA0F6BqB,IAGrDrB,EA7FwB,qBA6FF0B,QAAQ,gBAAG9B,IAAAA,MAAOgB,IAAAA,UAAWf,IAAAA,eACjDyB,WAAW,WAGJtB,EAjGe,sBAoGpBY,EAAUe,iBAAiB/B,EAAOC,GAAS,IAC1C,MAIP,SAAS+B,EAAO5B,IACGA,EA1GO,sBA0GkB,IACjC0B,QAAQ,qBAAUd,UACfiB,sBADQjC,QAAkBC,SACU,YAEzCG,EA9GiB,qBAyH1B,MAMeX,EANG,CAChBU,KAAAA,EACA+B,OAVF,SAAgB9B,SAAMS,IAAAA,MAAOsB,IAAAA,SACvBC,KAAKC,UAAUxB,KAAWuB,KAAKC,UAAUF,KAG7CH,EAAO5B,GACPD,EAAKC,EAAI,CAAES,MAAAA,MAMXmB,OAAAA,GAGuC,SC7H1B,CACbM,iBAAQC,GACNA,EAAIC,UAAU,gBAAiBA,IAEjCA,UAAAA"}